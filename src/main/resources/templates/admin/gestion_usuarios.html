<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Gestión de Usuarios</title>

	<!-- Bootstrap & FontAwesome -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

</head>

<body class="bg-light" style="font-family: 'Montserrat', sans-serif;">

	<!-- Navbar -->
	<div th:replace="menu :: navbar"></div>

	<!-- Encabezado -->
	<section class="container text-center my-5">
		<h2 class="fw-bold text-primary mb-3">
			<i class="fa-solid fa-users-gear me-2"></i> Gestión de Usuarios
		</h2>
		<p class="lead text-muted mb-0">Administra los usuarios registrados en LibroLink</p>
	</section>

	<!-- Contenido principal -->
	<section class="container mb-5">
		<div class="card border-0 shadow-lg rounded-4">
			<div class="card-body p-4">

				<!-- Formulario de búsqueda y filtro -->
				<form class="row g-3 mb-4" th:action="@{/admin/usuarios}" method="get">
					<div class="col-md-5">
						<input type="text" name="busqueda" class="form-control shadow-sm"
							placeholder="Buscar por nombre o email" th:value="${param.busqueda}">
					</div>
					<div class="col-md-4">
						<select name="rol" class="form-select shadow-sm">
							<option value="">Todos los roles</option>
							<option value="ROLE_USER" th:selected="${param.rol == 'ROLE_USER'}">Usuarios</option>
							<option value="ROLE_ADMIN" th:selected="${param.rol == 'ROLE_ADMIN'}">Administradores
							</option>
						</select>
					</div>
					<div class="col-md-3 d-grid">
						<button type="submit" class="btn btn-success shadow-sm">
							<i class="fa-solid fa-filter me-1"></i> Filtrar
						</button>
					</div>
				</form>

				<!-- Tabla de usuarios -->
				<div class="table-responsive" th:if="${not #lists.isEmpty(usuarios)}">
					<table class="table table-hover align-middle text-center">
						<thead class="table-primary">
							<tr>
								<th><i class="fa-solid fa-hashtag"></i></th>
								<th><i class="fa-solid fa-user me-2"></i> Nombre</th>
								<th><i class="fa-solid fa-envelope me-2"></i> Email</th>
								<th><i class="fa-solid fa-user-shield me-2"></i> Rol</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="usuario, iter : ${usuarios}">
								<td th:text="${iter.count}" class="fw-semibold"></td>
								<td th:text="${usuario.nombre}"></td>
								<td th:text="${usuario.email}"></td>
								<td>
									<span th:if="${usuario.rol.nombre == 'ROLE_ADMIN'}" class="badge bg-danger">
										<i class="fa-solid fa-shield-halved me-1"></i> Administrador
									</span>
									<span th:if="${usuario.rol.nombre == 'ROLE_USER'}" class="badge bg-primary">
										<i class="fa-solid fa-user me-1"></i> Usuario
									</span>
								</td>
							</tr>
						</tbody>
					</table>
				</div>

				<!-- Sin usuarios -->
				<div th:if="${#lists.isEmpty(usuarios)}" class="alert alert-warning text-center mt-4 shadow-sm">
					<i class="fas fa-exclamation-circle me-2"></i> No se encontraron usuarios registrados.
				</div>
			</div>
		</div>
	</section>

	<!-- Footer -->
	<div th:replace="footer :: footer"></div>

	<!-- Bootstrap & SweetAlert -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
	
</body>

</html>